# 其他接口

## getLocale

获取地区设置。

```typescript
getLocale(): Promise<Locale>;
```

其中 `Local` 的类型定义如下

```typescript
type Locale = "zh-CN" | "zh-HK" | "zh-TW" | "ja-JP" | "en-US" | "ko-KR" | "pt-BR" | "tr-TR" | "th-TH" | "id-ID" | "ms-MY"
```

#### 示例

```typescript
// 注意：⚠️在ui侧调用
const locale = await Dingdocs.base.host.getLocale();
// 'zh-CN'
```

## getTheme

获取当前主题。

```typescript
getTheme(): Promise<Theme>;
```

其中 `Theme` 类型定义如下：

```typescript
type Theme = 'light' | 'dark';
```

#### 示例

```typescript
const theme = await Dingdocs.base.host.getTheme();
// 'light'
```

## batchUploadFiles

批量上传附件

```typescript
batchUploadFiles(files: File[]): Promise<IOpenAttachment[]>;
```

其中 `IOpenAttachment` 类型定义可以参考[《附件字段》](https://alidocs.dingtalk.com/i/nodes/mweZ92PV6O36dZbns966Z9EAJxEKBD6p?utm_scene=team_space)

#### 示例

```typescript
const files = await Dingdocs.base.batchUploadFiles([file]);
```

## configPermission

**ISV 三方插件**，需要调用此方法，才允许使用 script api 读写 AI 表格数据

```typescript
configPermission: (
  agentId: string,
  corpId: string,
  timeStamp: number,
  nonceStr: string,
  signature: string,
  jsApiList: string[],
) => Promise<void>;

const JSAPI_LIST = ["DingdocsScript.base.readWriteAll"];
```

可参考：

[https://open.dingtalk.com/document/isvapp/obtain-jsapi\_ticket](https://open.dingtalk.com/document/isvapp/obtain-jsapi_ticket)

[《ISV接入AI表格开放API》](https://alidocs.dingtalk.com/i/nodes/GZLxjv9VGGDA9Ro2u0eQk13vV6EDybno)