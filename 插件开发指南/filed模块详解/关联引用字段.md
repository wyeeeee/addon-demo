# 关联引用字段

## 基本信息

LookupField 继承自基础 `Field`类，可以快捷地提供跨表的数据引用，并可以对数据按照你的需要进行后续的计算。

:::
关联引用字段 是一个只读字段，不能手动设置值。
:::

## 字段特有方法

### getValueAsync

获取指定记录在该字段中的值。

```typescript
getValueAsync(recordId: string): Promise<IOpenFormulaCellValue | null>

type IOpenFormulaCellValue = OpenApi.CellValue | OpenApi.CellValue[];
```

**参数**

*   `recordId`: `string` - 记录ID
    

**返回值**

*   `Promise<IOpenFormulaCellValue | null>` -  查找到的关联字段值，可能是单个值或数组，如果没有关联数据则返回null
    

**示例**

```typescript
// 获取记录的查找字段值
const lookupField = sheet.getField<LookupField>('客户名称');
if (lookupField) {
  const customerName = await lookupField.getValueAsync('rec_order_456');
  if (customerName !== null) {
    console.log(`关联的客户名称: ${customerName}`);
    
    // 如果查找字段返回多个值（多对多关联）
    if (Array.isArray(customerName)) {
      console.log(`找到${customerName.length}个关联客户`);
      customerName.forEach((name, index) => {
        console.log(`客户${index + 1}: ${name}`);
      });
    }
  } else {
    console.log('未找到关联的客户信息');
  }
}

```